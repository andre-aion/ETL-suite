2019-01-20 09:44:30,624 - [logs/miner_activity.log:16]=> logs/miner_activity.log
2019-01-20 09:44:30,764 - [logs/miner_activity.log:352]=> IN UPDATE: 276
2019-01-20 09:44:30,764 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-08
2019-01-20 09:44:30,766 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-02 00:00:00:2018-05-17 00:00:00
2019-01-20 09:44:30,929 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:30,935 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:30,966 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:44:35,968 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-09 00:00:00
2019-01-20 09:44:35,974 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-10 00:00:00:2018-05-11 00:00:00
2019-01-20 09:44:36,121 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:36,124 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:44:36,127 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:36,137 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:44:41,143 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-10 00:00:00
2019-01-20 09:44:41,149 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-11 00:00:00:2018-05-12 00:00:00
2019-01-20 09:44:41,288 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:41,291 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:44:41,293 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:41,303 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:44:46,305 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-11 00:00:00
2019-01-20 09:44:46,311 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-12 00:00:00:2018-05-13 00:00:00
2019-01-20 09:44:46,433 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:46,436 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:44:46,438 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:46,449 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:44:51,454 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-12 00:00:00
2019-01-20 09:44:51,460 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-13 00:00:00:2018-05-14 00:00:00
2019-01-20 09:44:51,599 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:51,601 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:44:51,604 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:51,613 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:44:56,616 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-13 00:00:00
2019-01-20 09:44:56,622 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-14 00:00:00:2018-05-15 00:00:00
2019-01-20 09:44:56,746 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:44:56,749 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:44:56,752 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:44:56,761 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:01,763 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-14 00:00:00
2019-01-20 09:45:01,769 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-15 00:00:00:2018-05-16 00:00:00
2019-01-20 09:45:01,911 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:01,914 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:01,917 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:01,926 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:06,928 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-15 00:00:00
2019-01-20 09:45:06,934 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-16 00:00:00:2018-05-17 00:00:00
2019-01-20 09:45:07,032 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:07,035 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:07,038 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:07,047 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:12,052 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-16 00:00:00
2019-01-20 09:45:12,056 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-17 00:00:00:2018-05-18 00:00:00
2019-01-20 09:45:12,171 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:12,174 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:12,177 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:12,187 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:17,191 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-17 00:00:00
2019-01-20 09:45:17,197 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-18 00:00:00:2018-05-19 00:00:00
2019-01-20 09:45:17,321 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:17,324 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:17,326 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:17,335 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:22,338 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-18 00:00:00
2019-01-20 09:45:22,343 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-19 00:00:00:2018-05-20 00:00:00
2019-01-20 09:45:22,465 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:22,468 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:22,471 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:22,480 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:27,486 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-19 00:00:00
2019-01-20 09:45:27,492 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-20 00:00:00:2018-05-21 00:00:00
2019-01-20 09:45:27,747 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=15
0       datetime64[ns]
666                ...
             ...      
9324               ...
9975               ...
Name: block_timestamp, dtype: datetime64[ns]
Dask Name: getitem, 30 tasks
2019-01-20 09:45:27,754 - [logs/miner_activity.log:132]=> line 114, one day  before concat:      block_timestamp  difficulty  block_nrg_consumed  nrg_limit     ...                                                 to_addr  approx_value  transaction_nrg_consumed    nrg_price
0 2018-05-21 00:00:09   6378130.0                   0   15004565     ...                                                 unknown       0.00000                         0            0
1 2018-05-21 00:00:55   6375016.0                   0   14989913     ...                                                 unknown       0.00000                         0            0
2 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a076c011b4a7b860020833bf8123c7635cd56d04e1b71d...       0.68964                     21000  10000000000
3 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a02453677e411f31ee0ec9f3ace911e0786fabafe20f88...       1.37929                     21000  10000000000
4 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a03bc05bbb22f828d8b6abfab4691a52cf037dde2eef85...       0.30654                     21000  10000000000
5 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0f7457d262d027e026f2c1719c9c584636e9a31810195...       2.75867                     21000  10000000000
6 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0fb44c6007b9d0ccbf7ff7b0a33c38712fd480b9c6b8d...       0.00000                     21000  10000000000
7 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0d3d3f2db5dff7855e72ea41ff3b204094865c83212bb...       3.44837                     21000  10000000000
8 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a05e738369ef46f08873261419a8986a6cfcdcc72a720a...       1.37955                     21000  10000000000
9 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a07850de7254aab7bb6d8cc7387604145b1f69ed05c9ed...       1.37952                     21000  10000000000

[10 rows x 13 columns]
2019-01-20 09:45:28,369 - [logs/miner_activity.log:143]=> 
Traceback (most recent call last):
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 377, in _convert_listlike
    values, tz = conversion.datetime_to_datetime64(arg)
  File "pandas/_libs/tslibs/conversion.pyx", line 188, in pandas._libs.tslibs.conversion.datetime_to_datetime64
TypeError: Unrecognized value type: <class 'str'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 137, in raise_on_meta_error
    yield
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/utils.py", line 688, in __call__
    return getattr(obj, self.method)(*args, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/series.py", line 2998, in map
    arg, na_action=na_action)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/base.py", line 1004, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/src/inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 79, in cast_date
    x = pd.to_datetime(x,format=self.DATEFORMAT)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 469, in to_datetime
    result = _convert_listlike(np.array([arg]), box, format)[0]
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 380, in _convert_listlike
    raise e
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 368, in _convert_listlike
    require_iso8601=require_iso8601
  File "pandas/_libs/tslib.pyx", line 492, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 620, in pandas._libs.tslib.array_to_datetime
ValueError: time data foo doesn't match format specified

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 134, in manage_sliding_df
    self.df['block_timestamp'] = self.df['block_timestamp'].map(self.cast_date)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 2099, in map
    meta = _emulate(M.map, self, arg, na_action=na_action, udf=True)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/contextlib.py", line 77, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 154, in raise_on_meta_error
    raise ValueError(msg)
ValueError: Metadata inference failed in `map`.

You have supplied a custom function and Dask is unable to 
determine the type of output that that function returns. 

To resolve this please provide a meta= keyword.
The docstring of the Dask function you ran should have more information.

Original error is below:
------------------------
ValueError("time data foo doesn't match format specified",)

Traceback:
---------
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 137, in raise_on_meta_error
    yield
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/utils.py", line 688, in __call__
    return getattr(obj, self.method)(*args, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/series.py", line 2998, in map
    arg, na_action=na_action)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/base.py", line 1004, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/src/inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 79, in cast_date
    x = pd.to_datetime(x,format=self.DATEFORMAT)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 469, in to_datetime
    result = _convert_listlike(np.array([arg]), box, format)[0]
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 380, in _convert_listlike
    raise e
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 368, in _convert_listlike
    require_iso8601=require_iso8601
  File "pandas/_libs/tslib.pyx", line 492, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 620, in pandas._libs.tslib.array_to_datetime

2019-01-20 09:45:52,858 - [logs/miner_activity.log:16]=> logs/miner_activity.log
2019-01-20 09:45:53,176 - [logs/miner_activity.log:352]=> IN UPDATE: 276
2019-01-20 09:45:53,177 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-08
2019-01-20 09:45:53,178 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-02 00:00:00:2018-05-17 00:00:00
2019-01-20 09:45:53,337 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:53,343 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:53,373 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:45:58,378 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-09 00:00:00
2019-01-20 09:45:58,383 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-10 00:00:00:2018-05-11 00:00:00
2019-01-20 09:45:58,508 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:45:58,511 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:45:58,514 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:45:58,523 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:03,529 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-10 00:00:00
2019-01-20 09:46:03,535 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-11 00:00:00:2018-05-12 00:00:00
2019-01-20 09:46:03,672 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:03,675 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:03,678 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:03,689 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:08,692 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-11 00:00:00
2019-01-20 09:46:08,697 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-12 00:00:00:2018-05-13 00:00:00
2019-01-20 09:46:08,830 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:08,833 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:08,835 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:08,847 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:13,852 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-12 00:00:00
2019-01-20 09:46:13,858 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-13 00:00:00:2018-05-14 00:00:00
2019-01-20 09:46:14,000 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:14,002 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:14,004 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:14,014 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:19,015 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-13 00:00:00
2019-01-20 09:46:19,021 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-14 00:00:00:2018-05-15 00:00:00
2019-01-20 09:46:19,146 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:19,149 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:19,152 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:19,162 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:24,164 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-14 00:00:00
2019-01-20 09:46:24,170 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-15 00:00:00:2018-05-16 00:00:00
2019-01-20 09:46:24,295 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:24,298 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:24,301 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:24,312 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:29,315 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-15 00:00:00
2019-01-20 09:46:29,321 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-16 00:00:00:2018-05-17 00:00:00
2019-01-20 09:46:29,447 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:29,450 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:29,452 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:29,462 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:34,466 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-16 00:00:00
2019-01-20 09:46:34,472 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-17 00:00:00:2018-05-18 00:00:00
2019-01-20 09:46:34,608 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:34,611 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:34,613 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:34,624 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:39,626 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-17 00:00:00
2019-01-20 09:46:39,632 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-18 00:00:00:2018-05-19 00:00:00
2019-01-20 09:46:39,754 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:39,757 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:39,759 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:39,769 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:44,770 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-18 00:00:00
2019-01-20 09:46:44,776 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-19 00:00:00:2018-05-20 00:00:00
2019-01-20 09:46:44,898 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=1
    object
       ...
Name: block_timestamp, dtype: object
Dask Name: getitem, 2 tasks
2019-01-20 09:46:44,900 - [logs/miner_activity.log:137]=> one day loaded
2019-01-20 09:46:44,903 - [logs/miner_activity.log:187]=> INSIDE UPDATE CHECKPOINT DICT
2019-01-20 09:46:44,913 - [logs/miner_activity.log:426]=> CHECKPOINT:NOT UP TO DATE
2019-01-20 09:46:49,919 - [logs/miner_activity.log:362]=> OFFSET INCREASED:2018-05-19 00:00:00
2019-01-20 09:46:49,925 - [logs/miner_activity.log:172]=> BEFORE LOAD DATA 2018-05-20 00:00:00:2018-05-21 00:00:00
2019-01-20 09:46:50,179 - [logs/miner_activity.log:176]=> line 157, load:Dask Series Structure:
npartitions=15
0       datetime64[ns]
666                ...
             ...      
9324               ...
9975               ...
Name: block_timestamp, dtype: datetime64[ns]
Dask Name: getitem, 30 tasks
2019-01-20 09:46:50,190 - [logs/miner_activity.log:132]=> line 114, one day  before concat:      block_timestamp  difficulty  block_nrg_consumed  nrg_limit     ...                                                 to_addr  approx_value  transaction_nrg_consumed    nrg_price
0 2018-05-21 00:00:09   6378130.0                   0   15004565     ...                                                 unknown       0.00000                         0            0
1 2018-05-21 00:00:55   6375016.0                   0   14989913     ...                                                 unknown       0.00000                         0            0
2 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a076c011b4a7b860020833bf8123c7635cd56d04e1b71d...       0.68964                     21000  10000000000
3 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a02453677e411f31ee0ec9f3ace911e0786fabafe20f88...       1.37929                     21000  10000000000
4 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a03bc05bbb22f828d8b6abfab4691a52cf037dde2eef85...       0.30654                     21000  10000000000
5 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0f7457d262d027e026f2c1719c9c584636e9a31810195...       2.75867                     21000  10000000000
6 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0fb44c6007b9d0ccbf7ff7b0a33c38712fd480b9c6b8d...       0.00000                     21000  10000000000
7 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a0d3d3f2db5dff7855e72ea41ff3b204094865c83212bb...       3.44837                     21000  10000000000
8 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a05e738369ef46f08873261419a8986a6cfcdcc72a720a...       1.37955                     21000  10000000000
9 2018-05-21 00:01:33   6362568.0              378000   15004551     ...       a07850de7254aab7bb6d8cc7387604145b1f69ed05c9ed...       1.37952                     21000  10000000000

[10 rows x 13 columns]
2019-01-20 09:46:50,815 - [logs/miner_activity.log:143]=> 
Traceback (most recent call last):
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 377, in _convert_listlike
    values, tz = conversion.datetime_to_datetime64(arg)
  File "pandas/_libs/tslibs/conversion.pyx", line 188, in pandas._libs.tslibs.conversion.datetime_to_datetime64
TypeError: Unrecognized value type: <class 'str'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 137, in raise_on_meta_error
    yield
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/utils.py", line 688, in __call__
    return getattr(obj, self.method)(*args, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/series.py", line 2998, in map
    arg, na_action=na_action)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/base.py", line 1004, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/src/inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 79, in cast_date
    x = pd.to_datetime(x)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 469, in to_datetime
    result = _convert_listlike(np.array([arg]), box, format)[0]
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 380, in _convert_listlike
    raise e
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 368, in _convert_listlike
    require_iso8601=require_iso8601
  File "pandas/_libs/tslib.pyx", line 492, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 739, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 733, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslibs/parsing.pyx", line 99, in pandas._libs.tslibs.parsing.parse_datetime_string
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dateutil/parser/_parser.py", line 1356, in parse
    return DEFAULTPARSER.parse(timestr, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dateutil/parser/_parser.py", line 648, in parse
    raise ValueError("Unknown string format:", timestr)
ValueError: ('Unknown string format:', 'foo')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 134, in manage_sliding_df
    self.df['block_timestamp'] = self.df['block_timestamp'].map(self.cast_date)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 2099, in map
    meta = _emulate(M.map, self, arg, na_action=na_action, udf=True)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/contextlib.py", line 77, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 154, in raise_on_meta_error
    raise ValueError(msg)
ValueError: Metadata inference failed in `map`.

You have supplied a custom function and Dask is unable to 
determine the type of output that that function returns. 

To resolve this please provide a meta= keyword.
The docstring of the Dask function you ran should have more information.

Original error is below:
------------------------
ValueError('Unknown string format:', 'foo')

Traceback:
---------
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/utils.py", line 137, in raise_on_meta_error
    yield
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/dataframe/core.py", line 3583, in _emulate
    return func(*_extract_meta(args, True), **_extract_meta(kwargs, True))
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dask/utils.py", line 688, in __call__
    return getattr(obj, self.method)(*args, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/series.py", line 2998, in map
    arg, na_action=na_action)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/base.py", line 1004, in _map_values
    new_values = map_f(values, mapper)
  File "pandas/_libs/src/inference.pyx", line 1472, in pandas._libs.lib.map_infer
  File "/home/andre/aion/data_science/bokeh/mysql_clickhouse_streamer/scripts/ETL/miner_activity.py", line 79, in cast_date
    x = pd.to_datetime(x)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 469, in to_datetime
    result = _convert_listlike(np.array([arg]), box, format)[0]
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 380, in _convert_listlike
    raise e
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/pandas/core/tools/datetimes.py", line 368, in _convert_listlike
    require_iso8601=require_iso8601
  File "pandas/_libs/tslib.pyx", line 492, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 739, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslib.pyx", line 733, in pandas._libs.tslib.array_to_datetime
  File "pandas/_libs/tslibs/parsing.pyx", line 99, in pandas._libs.tslibs.parsing.parse_datetime_string
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dateutil/parser/_parser.py", line 1356, in parse
    return DEFAULTPARSER.parse(timestr, **kwargs)
  File "/home/andre/anaconda3/envs/bokeh_aion_analytics/lib/python3.5/site-packages/dateutil/parser/_parser.py", line 648, in parse
    raise ValueError("Unknown string format:", timestr)

